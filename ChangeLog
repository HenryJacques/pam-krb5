commit 2120d7749f9e7ac4dd4b94191363f45fac4b41d3
tree ee0922662d7149a32786128aca38d0189b0c526c
parent f8deeb924a74c6f01370a6b73e35380121f50015
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 20:36:22 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 20:36:22 -0400

    Release 1.2.0

commit f8deeb924a74c6f01370a6b73e35380121f50015
tree 8f2f33287d5b5f8f7e174f0053dddf9cfcc76fdc
parent 8a77f66be7ce8223b75e625c509337bfdb064a03
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 20:20:10 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 20:20:10 -0400

    Add valid_context(), and move context checks into the function.

commit 8a77f66be7ce8223b75e625c509337bfdb064a03
tree 6d1c94b89de2bbfec4e1c097f251c187a6b7f049
parent a06cf338b776dd941d6723b2e8c300676dacbe77
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 20:10:22 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 20:10:22 -0400

    Break context related functions out into a separate file (context.c), and
    have context structs allocated from within new_context().

commit a06cf338b776dd941d6723b2e8c300676dacbe77
tree 79530d17eac11efbda0d91df2d9e41c705b503c3
parent 5ee014052f8a70baf468f1b1e8f1d70a3cf0df82
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 19:50:26 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 19:50:26 -0400

    Drop princ_name from the context struct, and no longer present the principal
    name in the Password prompt.

commit 5ee014052f8a70baf468f1b1e8f1d70a3cf0df82
tree d20b0a3cb150f852075bed750f905cd7e203cd32
parent c9c8022cc36007d6a88a1c996121dc675c6347b9
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 19:45:37 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 19:45:37 -0400

    Separate argument handling from context handling; that was always a bit
    awkward.  Now argument struct is global.  This allows us to log entry points
    much better, as ctx isn't required to be initialized first.

commit c9c8022cc36007d6a88a1c996121dc675c6347b9
tree f69ef810812ac931f2ce7336c58ed0f22c901361
parent 27d81a2b3723fe2f65f9003eafcf91914f254682
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 19:21:05 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 19:21:05 -0400

    Rename pam_krb5_context to context

commit 27d81a2b3723fe2f65f9003eafcf91914f254682
tree d112585ef243ac4f23df5fd07a2105cffdcabd99
parent a6a5f16715d7c72334295c071aefbd92b7db3975
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 15:30:39 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 15:30:39 -0400

    We were destroying the ccache in some instances when REINIT'ing; when the
    old ccache and new ccache have the same name, destroying one removes the
    file out from under the other.

commit a6a5f16715d7c72334295c071aefbd92b7db3975
tree 3d03c833c771cc6d997f37beeb3b20a4136d750f
parent d99f815c43af9eea2a3765ff7f0ede42601058e9
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 15:29:18 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 15:29:18 -0400

    Add a credlist structure, and manually copy lists of creds around.  libkrb5's
    interface is rather annoying for this sort of thing, so it's easier to just
    do it myself.  Once we have a nice creds list, dealing with creds between
    functions becomes much easier.

commit d99f815c43af9eea2a3765ff7f0ede42601058e9
tree 16b9406818e7d13f1b6582c800a8402de0dd102c
parent e8c1f189e6cea49d857a58d41a7fac65375c25d2
author Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 15:27:48 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 27 Sep 2005 15:27:48 -0400

    Let's not be shy about setting KRB5CCNAME; do it always, even if REINIT'ing.

commit e8c1f189e6cea49d857a58d41a7fac65375c25d2
tree 3a48a7a0d458570b6982b91037f1a271bc56e306
parent c4a9f599c9970e533eb153b9404ef5324c1fecd4
author Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 17:10:06 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 17:10:06 -0400

    There are some weird instances (most notably, sshd) where the process
    that calls setcred REINIT doesn't have KRB5CCNAME set in its environment.
    However, it does have the valid cache name in its ctx; so, pull the name
    from there if REINITing and we can't get the KRB5CCNAME.

commit c4a9f599c9970e533eb153b9404ef5324c1fecd4
tree e514c1bc9c024961e326b9b9c1e41eb05e132f58
parent f8773781ed4e17b67400bee756f7ffd5d837da17
author Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 16:53:55 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 16:53:55 -0400

    Drop the FILE: prefix in cache_name; there's the krb5 libs should assume
    that we're dealing with files.

commit f8773781ed4e17b67400bee756f7ffd5d837da17
tree f3b74536c0e6ab137569735139fdee77073f3938
parent cb682eb42591067cec1ae4c1e4910de09c85f1c8
author Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 16:51:31 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 16:51:31 -0400

    Be a bit stricter when doing a REINIT/REFRESH_CREDS; if KRB5CCNAME isn't
    set in the environment, bail out.  We can't refresh creds if we can't find
    the creds cache.

commit cb682eb42591067cec1ae4c1e4910de09c85f1c8
tree 87cffa49160a20f4ee36e185478d18240f78374d
parent d22cdbb12dfe439e15e0279f7f04f6a3c778c0fa
author Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 15:58:04 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 15:58:04 -0400

    Drop the "ccache=" argument to the module; it was a little ridiculous.
    There's little to be gained by forcing the filename form, and it required
    a lot of additional complexity.  Instead, I've replaced it with
    "ccache_dir="; this allows the base directory for ccache files to be set.
    By default, ccache_dir=/tmp.

commit d22cdbb12dfe439e15e0279f7f04f6a3c778c0fa
tree db246b3fac67759374d9a8a32ac42b14ce954c12
parent 436c5f55e300ca29c2b415fb2646ff409047f4c8
author Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 15:57:30 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 15 Sep 2005 15:57:30 -0400

    Add a bit more debugging output; always log the ccache name

commit 436c5f55e300ca29c2b415fb2646ff409047f4c8
tree 659a52ea0b4cfaf278a0e5edcf686c55178e18b6
parent 953fbf9d9d3fd56869f975e21cd2db9f4fc64721
author Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 18:10:36 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 18:10:36 -0400

    Release 1.1

commit 953fbf9d9d3fd56869f975e21cd2db9f4fc64721
tree 8b082df276b09a5bcd3148d8fcd3e9595860ba17
parent 7e0ae5bd28785c8f0f6b83f95ff56559e73545b8
author Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:44:38 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:44:38 -0400

    add some copyright info

commit 7e0ae5bd28785c8f0f6b83f95ff56559e73545b8
tree 72e0d5a068044e7838b420dfb206e3d6585c7095
parent 054162c3765fe518e00ba9ac643d052015b01907
author Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:15:58 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:15:58 -0400

    comment on the to_local_user stuff

commit 054162c3765fe518e00ba9ac643d052015b01907
tree 4f8c9a0da32afd12950e2855960b302467a3359c
parent e4ec6139a4ef743591a76e1fb9a4825b8e5a70d0
author Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:08:50 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:08:50 -0400

    disable logging to files and stderr by default

commit e4ec6139a4ef743591a76e1fb9a4825b8e5a70d0
tree febb851e5c7d37b0364621966514184a98c7fd34
parent 8c40138a317b5f2f1a26eb9ea969c7f181dff72c
author Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:04:49 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 31 Aug 2005 17:04:49 -0400

    don't allow a semi-initialized ctx to pass through the cracks..

commit 8c40138a317b5f2f1a26eb9ea969c7f181dff72c
tree 45024438c6cddbc7e8d06e01cfbb2677e74b2f01
parent 08a2673fc21d071e4aab44b3b1518338f589846b
author Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 19:18:28 -0400
committer Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 19:18:28 -0400

    Add support for reinit/refresh of creds in setcred.  This could certainly
    be made to be a bit less destructive; currently it simply follows the lead
    of kinit and reinitializing the existing ccache.  It might be the case that
    openafs's pam module needs to support reinit/refresh as well, as I seem to
    lose my afs token after this.  No matter, though; it still works. :)

commit 08a2673fc21d071e4aab44b3b1518338f589846b
tree 30fceafe0934cfa6ffb99b082773f986999c3659
parent 25548a29031a619d857dd6cffdfea72f28d1c2a9
author Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 18:36:38 -0400
committer Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 18:36:38 -0400

    remove some stale code; no need to overwrite ctx once pam's got it

commit 25548a29031a619d857dd6cffdfea72f28d1c2a9
tree 86236644f6a5512f97a1410eb88239ae3d3a52e9
parent 3f7183f6e66e382e53ee74eb594c57ff4880874b
author Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 18:19:23 -0400
committer Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 18:19:23 -0400

    Fix up debugging stuff; provide some sane debugging for syslog, stderr, and
    to file.  Lose the macro, w/ its hidden variable usage that broke far too
    frequently.

commit 3f7183f6e66e382e53ee74eb594c57ff4880874b
tree 3c9c53e32846773357dfe5b2dfa2b59ecbe495c4
parent e4b480f047ac821d5dcd2b340c6912d8a6df490e
author Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 17:11:42 -0400
committer Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 17:11:42 -0400

    yea... how about we don't leak cache_name and cache_env_name memory?

commit e4b480f047ac821d5dcd2b340c6912d8a6df490e
tree 4146800e8d112b958965b413af901b29baf7b22c
parent 88402917f038c3e5433858ec854f3b3ca28a9ad1
author Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 17:04:04 -0400
committer Andres Salomon <dilinger@athenacr.com> Fri, 19 Aug 2005 17:04:04 -0400

    Correctly deal w/ PAM_AUTHTOK and PAM_OLDAUTHTOK; both for the benefit
    of this module and others (pam_unix was not liking the fact that PAM_AUTHTOK
    wasn't being set for its try_first_pass).

commit 88402917f038c3e5433858ec854f3b3ca28a9ad1
tree c8c823ad2c43c5ec96761369f7fe8817526ad77c
parent e94f69a71b7d3a940a7adbd349c441009d33affb
author Andres Salomon <dilinger@athenacr.com> Thu, 18 Aug 2005 19:07:09 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 18 Aug 2005 19:07:09 -0400

    properly destroy credential cache

commit e94f69a71b7d3a940a7adbd349c441009d33affb
tree b6691ef504b819a7b50ef26c22b27e1e7fb03b8b
parent 67ef57e0720e9e46bf2d5d0e6216da40d1123e71
author Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 18:33:39 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 18:33:39 -0400

    oops, move ignore_root check after prompt is set, otherwise we segfault
    if debugging is enabled

commit 67ef57e0720e9e46bf2d5d0e6216da40d1123e71
tree 2d2dd6f8fd33e88280e88316fb4a162a63e02e30
parent 491b245d9cb45d60d854c8e9a4947ce385b9f31f
author Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 18:28:39 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 18:28:39 -0400

    add ignore_root support

commit 491b245d9cb45d60d854c8e9a4947ce385b9f31f
tree 27362c75c96a23b44ca9ccf0f03a3e4b8947d990
parent e1b9742ae2a79f2287518e795745cdd916f4dffd
author Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:46:16 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:46:16 -0400

    add comment about kuserok check change from prior commit

commit e1b9742ae2a79f2287518e795745cdd916f4dffd
tree 6b765e8610b43dcf65fe4179df286c96cc66a23f
parent e1a82d6996885c556a3878c28843e76658c06bad
author Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:45:06 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:45:06 -0400

    never return an unauthenticated context from fetch_context()

commit e1a82d6996885c556a3878c28843e76658c06bad
tree 5f051eb5a0c4e7ca2fe5c5aff297653f84440e0e
parent f66c4112bd00d0b42894cf825bec46ee2116b987
author Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:41:12 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:41:12 -0400

    ensure context isn't destroyed twice

commit f66c4112bd00d0b42894cf825bec46ee2116b987
tree 29294b6101d84e4b056a0284f9bca4d3ad22a4da
parent 99304aa0a11d8a7a564a9c68e94e4bf0be2a15e5
author Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:03:47 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 06 Jul 2005 15:03:47 -0400

    fix buglet where correct result was not propogated if pam_set_item fails

commit 99304aa0a11d8a7a564a9c68e94e4bf0be2a15e5
tree b84e6b377974b8ee9929b40493f7a2e4bf9c291f
parent a59a1d8f8246f2b4865024dd2fcf26166add501c
author Andres Salomon <dilinger@athenacr.com> Thu, 23 Jun 2005 12:44:58 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 23 Jun 2005 12:44:58 -0400

    fix buglet where password_auth fails but PAM_SUCCESS is still returned (oops)

commit a59a1d8f8246f2b4865024dd2fcf26166add501c
tree 4b892f5d88c2bb15fe251a45b4b142e4ce2b749a
parent aa8bfa2c98e7c19cc88c59486cad99df98f1ad4b
author Andres Salomon <dilinger@athenacr.com> Thu, 23 Jun 2005 12:44:29 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 23 Jun 2005 12:44:29 -0400

    miniscule debugging modifications

commit aa8bfa2c98e7c19cc88c59486cad99df98f1ad4b
tree 9996334b23b483a6da1d57b61b4cef748bb61a4c
parent 7d2f05858539dab68f1875be018f75eba084431f
author Andres Salomon <dilinger@athenacr.com> Wed, 22 Jun 2005 16:02:02 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 22 Jun 2005 16:02:02 -0400

    Make DLOG a bit more robust; make it handle varargs (yay!); make it an inlined
    function instead of a macro; make it not use teeth when giving head; make it
    support outputting to stderr instead of syslog, for cases when syslog cannot
    be written to (ie, when sudo calls pam_setcred).

commit 7d2f05858539dab68f1875be018f75eba084431f
tree 13c3b44e08da362524824e41612527494e1d59d0
parent c0e6fcf21efe27b027f1d924248e1abf76cc6c25
author Andres Salomon <dilinger@athenacr.com> Wed, 22 Jun 2005 15:55:55 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 22 Jun 2005 15:55:55 -0400

    fix bug where context is freed twice

commit c0e6fcf21efe27b027f1d924248e1abf76cc6c25
tree fe84e4ddc9900a21cf8bf02c597857c8188d722c
parent 250fdd0d9bbe75e9df756c16a9687b0dc59cc0f2
author Andres Salomon <dilinger@athenacr.com> Wed, 22 Jun 2005 15:54:27 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 22 Jun 2005 15:54:27 -0400

    fix buglet w/ uninitialized pointer

commit 250fdd0d9bbe75e9df756c16a9687b0dc59cc0f2
tree 7ec577c65b77000d079aeb28c06853e2ad09f48e
parent 417348576426663a20ed85ef5a993c62f9b74b52
author Andres Salomon <dilinger@athenacr.com> Tue, 21 Jun 2005 18:36:04 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 21 Jun 2005 18:36:04 -0400

    Hey, it compiles.. ship it!
    
    Yea, instead of storing just the name of the ccache in pam's memory, store
    the entire ctx structure, complete w/ initialized ccache and everything.
    There's no need to be redoing all this crap in every pam module call (I hope!).

commit 417348576426663a20ed85ef5a993c62f9b74b52
tree 6fa5285e8377eaca88896b369fb592b52e6e21cd
parent 4fd0d2844d4bf42387cae17473663381e13fa133
author Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 13:16:00 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 13:16:00 -0400

    Rework the password_auth stuff; get rid of that awful goto logic, replaced
    with some awful do-while logic.  Hopefully this is a bit clearer.  I'm sure
    there's a better (cleaner) way to do this; I'll see if I can clean it up
    further at some point in the future.

commit 4fd0d2844d4bf42387cae17473663381e13fa133
tree 69fd8527edfd49151e3c47c89a43e3f0c93b0817
parent 9eb9b007e717b7fb1ea0f1ea586a3781cd57c96d
author Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:48:07 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:48:07 -0400

    move args into a separate sub-struct

commit 9eb9b007e717b7fb1ea0f1ea586a3781cd57c96d
tree 7c68dd895764a2fa71351a3501718df0e6f35a00
parent 07b7426729a24938f112edabef8d9cb7246b0117
author Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:41:03 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:41:03 -0400

    Make errors more in line w/ what pam clients might expect (according to the
    official PAM module writers' documentation.  Which the official pam modules
    such as pam_unix tend to ignore, I might add).

commit 07b7426729a24938f112edabef8d9cb7246b0117
tree 91a1ecbb0594173d34fdd13a491738c173880c89
parent b751229a4156d27c38eb58affa6a4b6b123f064a
author Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:35:40 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:35:40 -0400

    formatting fixes/cleanups/etc

commit b751229a4156d27c38eb58affa6a4b6b123f064a
tree 389df09362e2549b0c9811f499efad9cd5aa8caa
parent 3f6b1c30397232ce5c72ac8c7952d8353899ab9e
author Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:30:27 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 20 Jun 2005 12:30:27 -0400

    fix reversed logic bug; if no ccache, user didn't use krb5 to log in.

commit 3f6b1c30397232ce5c72ac8c7952d8353899ab9e
tree fc5ed1d234c014a5bc88117a6b01e2fd4186c792
parent 5f02097d3323b831ae5c4e2866aeadf641beaf5e
author Andres Salomon <dilinger@athenacr.com> Thu, 26 May 2005 17:01:59 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 26 May 2005 17:01:59 -0400

    move the prompt generation into the password_auth function, and only include
    the principal in the prompt if debugging is turned on.  There's really no need
    to see this normally, and it also tends to break apps like gksudo which
    expect a plain "Password: " prompt.

commit 5f02097d3323b831ae5c4e2866aeadf641beaf5e
tree 3ed092030cef5143bb3a5914777ce9da4382f155
parent 96779860411d6f90b3a7f95e5436d92e7788da34
author Andres Salomon <dilinger@athenacr.com> Wed, 25 May 2005 15:46:07 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 25 May 2005 15:46:07 -0400

    fix a buglet w/ an uninitialized pointer, and add line# to debugging output

commit 96779860411d6f90b3a7f95e5436d92e7788da34
tree e68db64ac71d2f311aa8eccc9f723cd12928f398
parent f5f462583a5ee1f99ca92167bcf13efa9b45a070
author Andres Salomon <dilinger@athenacr.com> Wed, 25 May 2005 15:16:25 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 25 May 2005 15:16:25 -0400

    make the annoying "dereferencing type-punned pointer will break
    strict-aliasing rules" warnings go away.

commit f5f462583a5ee1f99ca92167bcf13efa9b45a070
tree 0c845b4bb59b62757eecfb1bbe79e470ca409112
parent 68f2094cbf2b063a37517e936a839b55422a27be
author Andres Salomon <dilinger@athenacr.com> Wed, 25 May 2005 15:14:11 -0400
committer Andres Salomon <dilinger@athenacr.com> Wed, 25 May 2005 15:14:11 -0400

    make it compile, fix some warnings, add a quiet flag to the context struct

commit 68f2094cbf2b063a37517e936a839b55422a27be
tree 42bd0968c8bf63472f087bdbd85931928037f1af
parent c96cbaf2b8fc9b44c3f453774259b14e3bf5e259
author Andres Salomon <dilinger@athenacr.com> Tue, 24 May 2005 17:29:16 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 24 May 2005 17:29:16 -0400

    split out password prompting into common functions

commit c96cbaf2b8fc9b44c3f453774259b14e3bf5e259
tree bb8defbe3689df44a094d485cb52df8af46614ac
parent 725bc8c55d0408e2a90652fa4d7b627184a67d9f
author Andres Salomon <dilinger@athenacr.com> Tue, 24 May 2005 15:54:31 -0400
committer Andres Salomon <dilinger@athenacr.com> Tue, 24 May 2005 15:54:31 -0400

    fix up some return value handling in acct function

commit 725bc8c55d0408e2a90652fa4d7b627184a67d9f
tree 0a53f2f360abe1d0f601c336410481a89edf6c09
parent 09485bf00817394fcd9484c1fce0b32fdbfbbf7c
author Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 19:48:58 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 19:48:58 -0400

    break principal stuff out into functions

commit 09485bf00817394fcd9484c1fce0b32fdbfbbf7c
tree 194e7c6b0b7046512c75018f19413dadced10cb9
parent 8df41b9d1a38349aacceb3be02665746ca0239c6
author Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 18:55:40 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 18:55:40 -0400

    minor formatting/fixes

commit 8df41b9d1a38349aacceb3be02665746ca0239c6
tree 438b6a648f0c794eaf69576398ea525f440c96ea
parent 10ca187d78d7f5a71e9e12cedd4116bc1369738f
author Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 18:30:59 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 18:30:59 -0400

    separate out function that switches to local user from principal

commit 10ca187d78d7f5a71e9e12cedd4116bc1369738f
tree 156bbd856060b28a7cff06adc1ab57c2fb32ba0e
parent 851c04a8f21f553788fdc085e3baa83686e270de
author Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 18:13:15 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 18:13:15 -0400

    call krb5_init_context during setup_context, and add a destroy_context
    function to take care of memory deallocation and krb5 stuff.

commit 851c04a8f21f553788fdc085e3baa83686e270de
tree c8c08eee2e282b37f98b7be598f682c0e81738d6
parent 51827185de401a5f7296a5e54e009f001ad0c086
author Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 16:05:55 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 16:05:55 -0400

    add setup_context, have it do the heavy lifting that create_context and
    get_name_and_service used to do.

commit 51827185de401a5f7296a5e54e009f001ad0c086
tree 97b230268593cfdd105bb34940cc0a89a576fad9
parent e6bb3830f17aab0e9a8375b40fdd4341d9003ef2
author Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 13:19:25 -0400
committer Andres Salomon <dilinger@athenacr.com> Mon, 23 May 2005 13:19:25 -0400

    rename pam_krb5_args to pam_krb5_context, and add pam handle to struct

commit e6bb3830f17aab0e9a8375b40fdd4341d9003ef2
tree c0196f71957dc4ab4f9d25679e91e8c66b629759
parent 8d0b4408f96694b758c7f07627ef7a3161859e29
author Andres Salomon <dilinger@athenacr.com> Thu, 19 May 2005 18:48:35 -0400
committer Andres Salomon <dilinger@athenacr.com> Thu, 19 May 2005 18:48:35 -0400

    create an args struct (pam_krb5_args), and put arg parsing into a
    separate function (parse_args).

commit 8d0b4408f96694b758c7f07627ef7a3161859e29
tree f77cef4ba1272e5fc24c8db57a38725fd45cf841
parent 095fb1e4ede1e380c6f0f4522984ed24cdf75f81
author Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 14:17:37 -0400
committer Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 14:17:37 -0400

    create get_name_and_service; move common code from all functions into there

commit 095fb1e4ede1e380c6f0f4522984ed24cdf75f81
tree 8d68cd54c14018f38ecc765d8e211ac6711e3875
parent 1ee8b918bb4dbc404009c9716f6254feaa57b9c0
author Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 13:35:01 -0400
committer Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 13:35:01 -0400

    wrap header file in #ifdefs

commit 1ee8b918bb4dbc404009c9716f6254feaa57b9c0
tree 603c78f60f5bc2db03d6b20e5939142cda1221f1
parent aac21c03b36e5ef21d51b181d7f12f517c9f28fd
author Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 13:30:44 -0400
committer Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 13:30:44 -0400

    remove redefined DLOG() crud, with hardcoded function names (*gag*).

commit aac21c03b36e5ef21d51b181d7f12f517c9f28fd
tree f7812c47fd9fb4a381aa442465f17dd0341a6e19
author Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 13:18:51 -0400
committer Andres Salomon <dilinger@jack.(none)> Thu, 19 May 2005 13:18:51 -0400

    Initial commit; based on 1.0-12

